---

copyright:
  years: 2017, 2019
lastupdated: "2019-04-05"

keywords: device simulator, devices

subcollection: iot-platform

---

{:new_window: target="blank"}
{:shortdesc: .shortdesc}
{:screen: .screen}
{:codeblock: .codeblock}
{:pre: .pre}
{:tip: .tip}
{:important: .important}


# デバイス・データのシミュレート
{: #sim_device_data}

<p>この {{site.data.keyword.cloud}} 資料コレクションは、{{site.data.keyword.iot_full}} ライトの料金プランが対象になっていて、基本的な入門情報や、API リファレンス、一般的なトラブルシューティング情報が含まれています。
全ての {{site.data.keyword.iot_short_notm}} 機能の資料については、IBM Knowledge Center 上の [{{site.data.keyword.iot_short_notm}} 製品資料 ![外部リンク・アイコン](../../icons/launch-glyph.svg "外部リンク・アイコン")](https://www.ibm.com/support/knowledgecenter/SSQP8H/iot/overview/overview.html) を参照してください。 各種プランの詳細については、[{{site.data.keyword.iot_short_notm}} のサービス・プラン](/docs/services/IoT?topic=iot-platform-plans_overview#plans_overview)を参照してください。 
</p>
{: important}

{{site.data.keyword.iot_full}} デバイス・シミュレーターを使用して、実際のデバイスに登録および接続することなく、{{site.data.keyword.iot_short_notm}} のフィーチャーが完全に機能することを確認、テスト、実証するためのデバイス用のシミュレート・イベントをセットアップできます。
{: shortdesc}

デバイス・シミュレーターを使用して、既存のデバイス・タイプについてのシミュレート・デバイスを作成したり、新しいデバイス・タイプおよびデバイスを作成したりできます。各シミュレート・デバイスは固有のイベント詳細を使用できますが、すべてのデバイスに適用されるデフォルト構成を作成することもできます。

## 始めに
{: #byb-simulation .sectiontitle}
ユーザー ID に対してデバイス・シミュレーションを有効にします。
1. {{site.data.keyword.iot_short_notm}} にログインします。
2. メイン・ナビゲーション・ペインで**「設定」**を選択します。
3. **「データおよびデバイス (Data and Devices)」**セクションで、デバイス・シミュレーターをアクティブにします。

ご使用のユーザー ID に対してデバイス・シミュレーションが有効化されている場合、{{site.data.keyword.iot_short_notm}} ダッシュボードにログインしたとき、有効化されたすべてのシミュレート・デバイスが自動的に開始します。

## デバイスのシミュレート
{: #process-simulation .sectiontitle}
アクティブ化された場合、デバイス・シミュレーターはすべてのダッシュボード・ページで使用可能になります。画面の右下隅のメッセージは、実行中のシミュレーションの数を示します。

**重要:** ユーザー ID に対して定義したシミュレート・デバイスおよびデバイス・タイプは、{{site.data.keyword.iot_short_notm}} 組織の別のユーザーが使用できます。ただし、デバイス用のシミュレート・データを生成するには、アクティブ・ユーザー・セッションで {{site.data.keyword.iot_short_notm}} ダッシュボードにログインしておく必要があります。

デバイス・データをシミュレートするには、以下のようにします。
1. {{site.data.keyword.iot_short_notm}} ダッシュボードから、「0 個のシミュレーションを実行中 (0 Simulations running)」メッセージをクリックします。
3. 開いている**「シミュレーション」**構成ウィンドウで、**「シミュレーションの作成」**をクリックします。
4. シミュレーションの詳細を構成します。  
**「シミュレーションのインポート/エクスポート」**をクリックして[既存の構成](#reuse)をインポートするか、次のようにして詳細情報を手動で構成します。
   1. データをシミュレートする既存のデバイス・タイプを選択するか、デバイス・タイプ名を入力して新しいデバイス・タイプを作成します。
   2. イベント・タイプのデフォルト名を変更します。
   3. **「スケジュール」**の下でイベントの頻度を設定します。
   4. イベント・ペイロードを編集します。  
   プロパティーおよびそれに対応する値を追加してサンプル JSON ペイロードを編集するか、[関数](#functions)を使用して、動的に生成されたデータ・ポイントを追加します。  
   [CSV イベント・ペイロード・ファイル](#csv)をアップロードしてペイロードをセットアップすることもできます。  
   {: tip}
5. **「新規イベント・タイプ」**をクリックして、デバイス・タイプ用のイベント・タイプをさらに追加して構成します。
5. **「イベントを履歴データとして保存 (Save events as historical data)」**を有効にし、あとでシミュレート・デバイスの状態データにアクセスできるようにします。  
履歴データを有効にしておくと、{{site.data.keyword.iot_short_notm}} [データ管理 ![外部リンク・アイコン](../../icons/launch-glyph.svg "外部リンク・アイコン")](https://www.ibm.com/support/knowledgecenter/SSQP8H/iot/platform/GA_information_management/ga_im_definitions.html){: new_window} コンポーネントが作成され、関連する論理インターフェースからシミュレート・デバイスの状態にアクセスできます。  
**重要:** 履歴データを保存するようにデバイス・タイプを有効化した後は、イベント・タイプの追加や削除を行ったり、イベント・ペイロードに存在するフィールドを変更したりすることはできません。
5. **「保存」**をクリックしてデバイス・タイプを作成します。  
これで 1 つ以上のシミュレート・デバイスを作成できるようになりました。
6. **「シミュレート・デバイスの作成」**をクリックしてデバイスを作成し、データの送信を開始します。  
**ヒント:** 複数のデバイスを作成するには、**「1 x」**をクリックして、作成するデバイス数を選択します。  
7. さらにシミュレーションを作成する場合は、**「新規シミュレーション」**をクリックし、カスタム設定を適用するデバイスごとにこの構成手順を繰り返します。   
画面右下隅のメッセージは、アクティブなシミュレーションの数を示します。
8. **「デバイス」**ページで、シミュレート・デバイスのいずれかを参照し、**「最近のイベント」**タブを選択して、シミュレート・イベントが作動していることを確認します。

[シミュレート・イベント構成をエクスポート](#reuse)して再利用または共有できます。

## イベント・タイプ関数
{: #functions .sectiontitle}

いくつかの特殊関数を使用して、イベント・タイプに対して動的なデータを作成することができます。

関数 |使用法|例
:--- | :---  | :--  
`random(lower, upper)`  | 指定されている範囲内の乱数を生成します。  | `{"random": random(0, 100)}`  
`$counter` | 現在のタイプのシミュレート・デバイスの数を表示します。 | `{"total": $counter}`  
`increment(start, increment)` | 開始値および増分の値を指定します。 |`{"myNumber": increment(10, 1)}` </br> この例で、`myNumber` は 10 から始まり、ペイロードの送信のたびに 1 ずつ増えていきます。


## CSV イベント・ペイロード・ファイル
{: #csv .sectiontitle}

特定のシナリオ用に制御されたイベント・データを作成する場合、CSV 入力ファイルでデータ・フローをセットアップできます。

### 要件
CSV ファイルが次の要件を満たしている必要があります。
- 以下の場合を除き、各値は有効な [JSON プリミティブ ![外部リンク・アイコン](../../icons/launch-glyph.svg "外部リンク・アイコン")](https://json.org){: new_window} です。
  - ストリング:   
  例: "Hello world"
  - 数値:  
  例: 0, 0.1, -22, -2.43
  - ブール値:  
true または false
  - null:  
  null
  - **サポート対象外:**
    - オブジェクト  
    例: {}
    - 配列  
    例: []
- 値はコンマ区切りである必要があります。
- 行は改行文字 (`\n`) を使用して区切る必要があります。
- ヘッダー行はストリング値のみで構成する必要があります。


### サンプル CSV ファイル
```
"temperature", "confidence","status"
1, 0.1, "normal"
2, 0.2, "normal"
3, 0.3, "error"
4, 0.4, "normal"
```

1 番目の行 (「ヘッダー行」) は、生成されるすべてのデバイス JSON イベント・オブジェクト内のデバイス JSON に含まれるプロパティーを決定します。
後続の各行 (「データ行」) は、生成される各デバイス JSON イベント・オブジェクト内のこれらのプロパティーの値を設定します。

**ヒント:** CSV ファイルをインポートするときに、**「ファイルからのシミュレーション・データのループ」**を選択すると、データ行を順番に循環させて連続するデータ・フィードを実現できます。このトグルを設定しない場合、CSV 内の各データ行は、スケジュールによって設定された頻度で 1 回のみ送信されます。

サンプル CSV ファイルは、結果として以下のタイプのイベント・ペイロードになります。
```JSON
{
  "temperature": 1,
  "confidence": 0.1,
  "status": "normal"
}
```

## シミュレーションの共有および再利用
{: #reuse .sectiontitle}

シミュレーションの詳細情報をエクスポートして再利用または共有できます。
1. **「シミュレーション」**ウィンドウで、**「インポート/エクスポート」**をクリックします。
2. **「エクスポート」**タブを選択します。
3. シミュレーションの詳細をクリップボードにコピーするか、JSON ファイルにダウンロードします。
