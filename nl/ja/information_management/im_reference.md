---

copyright:
years: 2017, 2018
lastupdated: "2018-03-06"

---

{:new_window: target="\_blank"}
{:shortdesc: .shortdesc}
{:screen: .screen}
{:codeblock: .codeblock}
{:pre: .pre}

# データ管理の参照情報

以下の情報を参照して、{{site.data.keyword.iot_full}} のデータ管理コンポーネントの使用時に適用される制約事項を把握してください。 

## スキーマの制約事項

データ管理では、以下のタイプのスキーマが使用されます。
- イベント・タイプ・スキーマ
- 論理インターフェース・スキーマ
- モノのタイプのスキーマ

以下の表に、各スキーマ・タイプに適用される制約事項を示します。

スキーマ・タイプ       |        制約
------------------- | -------------
すべて        | すべてのスキーマは、有効な JSON に準拠している必要があります。
すべて        | すべてのスキーマは、有効な JSON スキーマに準拠している必要があります。
すべて        | すべてのスキーマのルートは、タイプが「object」である必要があります。
すべて        | すべてのスキーマの最大ネスト・レベルは 7 です。
論理インターフェース        |  必須として指定されるすべてのプロパティーには、デフォルト値が定義されている必要があります。
論理インターフェース     | オブジェクトがスキーマで定義される場合、そのオブジェクトに対して少なくとも 1 つのプロパティーが定義される必要があります。
論理インターフェース | 配列がスキーマで定義される場合、関連項目のタイプは 1 つのみ (例えば、タイプ「string」のみ) にする必要があります。
モノのタイプ        | トップレベルのプロパティーのみが許可されます。第 1 レベルを超えるネストは許可されません。
モノのタイプ        | トップレベルのプロパティーは、タイプが「object」である必要があります。
モノのタイプ        | トップレベルのプロパティーは、$logicalInterfaceRef と 1 つのタイプを参照する必要があります。$logicalInterfaceRef の値は、論理インターフェースの ID または別名です。タイプは、「object」または「array」に設定する必要があります。

## 有効なスキーマと無効なスキーマの例

### 例 1 - 有効な論理インターフェース・スキーマの定義
以下の例は、『スキーマの制約事項』セクションで示した制約に準拠する論理インターフェース・スキーマを定義しています。

  - スキーマは、有効な JSON および有効な JSON スキーマに準拠しています。
  - スキーマのタイプは「object」です。
  - スキーマのネスト・レベルは 7 未満です。 
  - スキーマには 2 つのプロパティーが定義されています。 
  - 必須プロパティー **a** および **b** には、デフォルト値が指定されています。

```
{
 "type": "object",
 "properties":{
    "a":{
       "type":"string"
    },
    "b":{
       "type": "number"
      }
  },
  "default":{"a":"HelloWorld", "b":2},
  "required": ["a", "b"]
}
```


### 例 2 - 無効な論理インターフェース・スキーマの定義
以下の例は、無効な論理インターフェース・スキーマを示しています。配列がタイプ「string」またはタイプ「number」の項目を含むように定義されているため、スキーマは無効です。配列がスキーマで定義される場合、関連項目のタイプは 1 つのみ (例えば、「string」) にする必要があります。

```
{
 "type": "object",
 "properties":{
    "a":{
      "type":"array",
       "items":{
          "type": ["string", "number"]
       }
    }
  }
}
```
### 例 3 - 有効なモノ・タイプ・スキーマの定義
以下の例は、『スキーマの制約事項』セクションで示した制約に準拠するモノ・タイプ・スキーマを定義しています。

  - スキーマは、有効な JSON および有効な JSON スキーマに準拠しています。
  - スキーマのタイプは「object」です。
  - スキーマのネスト・レベルは 7 未満です。 
  - スキーマはトップレベルのプロパティーのみを定義しています。 
  - トップレベルのプロパティーは、$logicalInterfaceRef と、「array」または「object」に設定される 1 つのタイプを参照しています。タイプ「array」は、多くのデバイスまたはモノ (例えば、多くの温度センサー) を集約するために使用できます。タイプ「object」は、単一のデバイスまたはモノ (例えば、単一の湿度センサー) を参照するために使用できます。   
  - 必須プロパティーには、デフォルト値を指定する必要はありません。この制約は、論理インターフェース・スキーマにのみ適用されます。このスキーマ・タイプでは、デフォルト値を指定できません。 

```
{
   "type" : "object",
   "properties" : {
       "temperatureSensors": {
           "description": "Aggregated temperature sensors",
           "$logicalInterfaceRef": "IThermometer",
           "type" : "array"
       },
       "humiditySensor": {
           "description": "The humidity sensor device",
           "$logicalInterfaceRef": "5846cd7c6522050001db0e24"
            "type" : "object"
       }
   },
   "required" : [
       "temperatureSensors",
       "humiditySensor"
   ]
  }
```
